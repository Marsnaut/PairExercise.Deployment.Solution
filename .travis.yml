language: node_js
node_js:
  - node # uses most recent stable node version
services:
  - postgresql # starts up postgres
addons:
  postgresql: '9.6' # highest available postgres version on Travis
dist: trusty # uses trusty environment
sudo: false # when on trusty, uses Docker containers for speed
notifications:
  email:
    on_success: change # default: change (only when going from broken to fixed)
    on_failure: always # default: always (which is annoying, as it should be)
install:
  - npm ci # faster, goes only from package-lock
before_script:
  - psql -c 'create database "deployment-exercise-test";' -U postgres # remember to change this name if you change it elsewhere (e.g. package.json)

before_deploy:
  - npm run build-client # make the bundle
  - rm -rf node_modules # omit from the tarball, since we skip cleanup
deploy:
  skip_cleanup: true # prevents travis from deleting the build
  provider: heroku
  app: trials-and-tribs
  api_key:
    secure: "Hc+qcaXNKK8zvJg1xkLVCqUDb+ngLCCD30s+1iRoNyKaM+veiC0kldk3SxBKOLZNUPv4MmWcHHg1QIzNVI+AobFCl3n59NKutPIx4+BaWJ94KhfiQws5WurmJWD1z9LPE7COwuZpMXA2NS8WNghRAeqV/iV+V5yjnc8fsYCC+TnMVSOXXZKEgedfQKRQw+yLS8EdeUC7ZRRAVNgBDGs5qa5cKB5RqJmyAJDDNmIMNXlZWzCCQKs22HfrHfrc25juK1CptiIiTm+Zwzaybg+BZ8Fz4EGkYCqz+wEKiLdH2SkqQDLd4/+FlZkJ13Q1tKwrHoWZhO9sFhS6K6KgNFc3dwH8bLz91weIdAZWEzWT0XeX2eR11uzFBol0sslWuRlmMNvkPrxn3uO7ntquVhh/Tt9MTs7U0gx8wiBY6oQEQ4HzRRDGJbaWw741PEJ8e+TVbNiaQ9bJvJrn6hFdxmBAIXfxOa8hNKl5/Niu1kV8WJxdRpiaEjf69I+ObtO7l8R2i7WXkI+dxP1nJaagSnT51tw8BnA9H9qWr6DgzYINoIHnIveWk8T4WjCkfufb31TG3cIgzjn+ygw0Rg4/Z753rriVTlO4oEoY57yPJHzJdyMBm/0L5TDqFH9CTOwVY6JZEzgkIJSwkmb3Jat4UeG39KtfF94juRpITMk2VH3PGu4=" 
 